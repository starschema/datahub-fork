# Governance Action Configuration
# This action monitors entity changes and enforces governance rules in real-time

name: "governance_bot"

source:
  type: "kafka"
  config:
    connection:
      bootstrap: "broker:29092"
      schema_registry_url: "http://schema-registry:8081"
    topic_routes:
      mcl: "MetadataChangeLog_Versioned_v1"
      pe: "PlatformEvent_v1"

filter:
  event_type: "MetadataChangeLogEvent_v1"
  event:
    entityType: "dataset"
    aspectName:
      - "status"  # Always emitted during ingestion - ensures governance runs every time
      - "schemaMetadata"  # Emitted when schema changes
      - "datasetProperties"  # Emitted for dataset metadata
      - "ownership"
      - "globalTags"
      - "glossaryTerms"
      - "editableProperties"
      - "institutionalMemory"

action:
  type: "governance"
  config:
    enabled: true
    rules_file: "/etc/datahub/actions/conf/governance-rules.yml"

datahub:
  server: "http://datahub-gms:8080"
  # Authentication handled automatically via DATAHUB_SYSTEM_CLIENT_ID and DATAHUB_SYSTEM_CLIENT_SECRET env vars
